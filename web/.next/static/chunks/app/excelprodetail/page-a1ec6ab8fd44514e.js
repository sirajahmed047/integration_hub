(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[899],{7649:function(e,t,s){Promise.resolve().then(s.bind(s,4598))},4598:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(7437),i=s(2265),n=s(4659),l=s(4829),d=s(6302),c=s(5930);s(69);var components_CarbonTableSimple_CarbonTableSimple=e=>{let{columns:t,jsonData:s,headingText1:i,headingText2:l}=e;return s&&0!==s.length?(0,a.jsxs)("div",{className:"my-component",children:[(0,a.jsxs)("div",{className:"fin-header-section",children:[(0,a.jsx)("div",{className:"fin-text-heading",children:i}),(0,a.jsx)("div",{className:"fin-text-heading-label",children:l})]}),(0,a.jsx)("div",{className:"fin-container",children:(0,a.jsx)(n.xJi,{children:(0,a.jsxs)(n.iA_,{"aria-label":"sample table",children:[(0,a.jsx)(n.ssF,{children:(0,a.jsx)(n.SCH,{children:t.map(e=>(0,a.jsx)(n.xDH,{children:e}))})}),(0,a.jsx)(n.RMI,{children:Object.keys(s).map(e=>(0,a.jsxs)(n.SCH,{children:[(0,a.jsx)(n.pj1,{children:(0,a.jsx)("span",{className:"fin-validation-error",children:e})}),(0,a.jsx)(n.pj1,{children:s[e]})]}))})]})})})]}):(0,a.jsx)("p",{})},h=s(1516),r=s(4941),o=s(3354);s(5349);let ExcelDetailPage=class ExcelDetailPage extends i.Component{componentDidMount(){this.handlePageOnLoad()}handlePageOnLoad(){let e=new URLSearchParams(window.location.search),t=e.get("action"),s=e.get("id");"new"===t?this.handleNew():"load"===t?this.handleLoad(s):"clone"===t&&this.handleClone(s)}handleNew(){this.postRequest("/api/excelpro/loadnew",null,null,this.sucessCallBackLoadNew,{})}handleLoad(e){this.postRequest("/api/excelpro/load",null,null,this.sucessCallBackLoad,{id:e})}handleTemplateChange(){let e=this.state.main_data;this.postRequest("/api/excelpro/templatechange",this.startLoading,this.stopLoading,this.sucessCallBackTemplateChange,e)}handleClone(e){this.postRequest("/api/excelpro/load",null,null,this.sucessCallBackClone,{id:e})}render(){return(0,a.jsxs)(n.rjZ,{children:[(0,a.jsx)(n.sgG,{lg:16,md:8,sm:4,className:"landing-page__banner my-title-image",children:(0,a.jsx)("span",{className:"SubHeaderTitle",children:"Excel Data Processing"})}),(0,a.jsx)(n.sgG,{lg:16,md:8,sm:4,className:"landing-page__r2",children:(0,a.jsx)(n.rjZ,{className:"my-tabs-group-content",children:(0,a.jsx)(n.sgG,{md:4,lg:16,sm:4,className:"landing-page__tab-content",children:(0,a.jsx)("table",{className:"fin-table",children:(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:this.state.main_data&&(0,a.jsxs)("div",{className:"my-component",children:[(0,a.jsxs)("div",{className:"fin-header-section",children:[(0,a.jsx)("div",{className:"fin-text-heading",children:"Meta info"}),(0,a.jsxs)("div",{className:"fin-text-heading-label",children:["Enter the excel template information"," "]})]}),(0,a.jsx)("div",{className:"fin-container",children:(0,a.jsx)("table",{children:(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.oil,{class:"my-textbox",labelText:"Id",value:this.state.main_data.id,disabled:!0,onChange:e=>this.handleInputChange(e,"id")})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.oil,{class:"my-textbox",labelText:"Name",value:this.state.main_data.name,onChange:e=>this.handleInputChange(e,"name")})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.oil,{class:"my-textbox",labelText:"Desc",value:this.state.main_data.desc,onChange:e=>this.handleInputChange(e,"desc")})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.Ltx,{className:"gan-dropdown-operation",titleText:"Envizi Template",items:this.state.main_data.envizi_template_list,selectedItem:this.state.main_data.envizi_template,onChange:e=>this.handleDropDownChange(e,"envizi_template")})})})]})})})]})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"my-component",children:[(0,a.jsxs)("div",{className:"fin-header-section",children:[(0,a.jsx)("div",{className:"fin-text-heading",children:"Data Ingestion to Envizi"}),(0,a.jsx)("div",{className:"fin-text-heading-label",children:"Upload the excel file that contains your data."})]}),(0,a.jsx)("div",{className:"fin-container",children:(0,a.jsx)("table",{children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)("input",{type:"file",className:"file-class",onClick:this.handleFileChangePOC,onChange:this.handleFileChangePOC})}),(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:()=>{this.handleUploadData()},disabled:!this.state.selectedFilePOC,children:"Load source data"})}),(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:()=>{this.handleViewInScreen()},disabled:!this.state.resultUpload,children:"Preview"})}),(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:()=>{this.handleIngestToEnvizi()},disabled:!this.state.resultUpload,children:"Ingest to Envizi"})}),(0,a.jsx)("td",{className:"instruction-label",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:()=>{this.handleBack()},children:"Back"})})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"instruction-msg",children:!this.state.loading&&this.state.msg_process?(0,a.jsx)("span",{children:this.state.msg_process}):(0,a.jsx)("span",{})})})})]})})})]})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:this.state.resultIngest&&this.state.resultIngest.processed_data&&(0,a.jsxs)("span",{children:[(0,a.jsx)(h.Z,{columns:this.state.resultIngest.template_columns,jsonData:this.state.resultIngest.processed_data,headingText1:"Data Generated",headingText2:"The below data have been pushed to Envizi"}),this.state.resultIngest.validation_errors&&Object.keys(this.state.resultIngest.validation_errors).length>0&&(0,a.jsx)(components_CarbonTableSimple_CarbonTableSimple,{columns:["Error","Rows"],jsonData:this.state.resultIngest.validation_errors,headingText1:"Validation Errors",headingText2:"The below validation errors occured in the data"})]})})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:this.state.loading&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"\xa0"}),(0,a.jsx)(n.gbz,{description:"Loading content..."})]})})}),(0,a.jsx)("tr",{children:!this.state.loading&&this.state.main_data&&(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"my-component",children:[(0,a.jsxs)("div",{className:"fin-header-section",children:[(0,a.jsx)("div",{className:"fin-text-heading",children:"Data Mapping"}),(0,a.jsx)("div",{className:"fin-text-heading-label",children:"Map the data from your uploaded excel file to the template columns"})]}),(0,a.jsxs)("div",{className:"fin-container",children:[this.state.main_data.fields.map((e,t)=>(0,a.jsxs)("div",{className:"fin-mapping-container",children:[(0,a.jsx)("div",{className:"fin-mapping-container2",children:(0,a.jsxs)("div",{className:"fin-row",children:[(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)("div",{className:"fin-field-label",children:e.label})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.oil,{className:"fin-text-box",value:e.text_value,size:"md",onChange:t=>this.handleTextValueChange(t,e.name)})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.Ltx,{className:"gan-dropdown-uploaded-columns",items:this.state.uploaded_columns,selectedItem:e.uploaded_column,size:"md",type:"default",onChange:t=>this.handleUploadedColumnValueChange(t,e.name)})}),(0,a.jsx)("div",{className:"fin-column",children:3==e.type&&(0,a.jsx)(n.Ltx,{className:"gan-dropdown-existing-values",items:e.list_elements,size:"md",type:"default",selectedItem:e.list_value,onChange:t=>this.handleListValueChange(t,e.name)})})]})}),(0,a.jsx)("div",{className:"fin-mapping-container2",children:(2==e.type||3==e.type)&&e.list.map((t,s)=>(0,a.jsxs)("div",{className:"fin-row",children:[(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)("div",{className:"fin-field-label"})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.oil,{className:"fin-text-box1",value:t.text_value,onChange:t=>this.handleSubTextValueChange(t,e.name,s)})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.Ltx,{className:"gan-dropdown-uploaded-columns",items:this.state.uploaded_columns,selectedItem:t.uploaded_column,type:"default",onChange:t=>this.handleSubListValueChange(t,e.name,s)})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.Ltx,{className:"gan-dropdown-operation",items:t.operation_elements,selectedItem:t.operation_value,type:"default",onChange:t=>this.handleOperationListValueChange(t,e.name,s)})}),(0,a.jsxs)("div",{className:"fin-column",children:[(0,a.jsx)(n.zxk,{kind:"secondary",className:"fin-button-icon",hasIconOnly:!0,renderIcon:d.mm,iconDescription:"Add",size:"sm",onClick:()=>this.addField(e.name,s+1)}),(0,a.jsx)(n.zxk,{kind:"secondary",className:"fin-button-icon",hasIconOnly:!0,renderIcon:c.ZN,iconDescription:"Delete",size:"sm",onClick:()=>this.removeField(e.name,s)})]})]}))})]})),(0,a.jsx)("div",{className:"fin-mapping-container",children:(0,a.jsxs)("div",{className:"fin-row",children:[(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:this.handleSavePOC,children:"Save"})}),(0,a.jsx)("div",{className:"fin-column",children:(0,a.jsx)(n.zxk,{className:"fin-button-1",onClick:this.handleBack,children:"Back"})}),(0,a.jsx)("div",{className:"fin-row",children:(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"instruction-msg",children:this.state.msg_save&&this.state.msg_save})})})]})})]})]})})})]})})})})})]})}constructor(){super(),this.handleInputChange=(e,t)=>{this.setState(s=>{let a={...s};return a.main_data[t]=e.target.value,a})},this.handleDropDownChange=(e,t)=>{this.setState(s=>{let a={...s};return a.main_data[t]=e.selectedItem,a.resultUpload=null,a.resultIngest=null,this.handleTemplateChange(),a})},this.handleFileChangePOC=e=>{this.setState(t=>{let s={...t};return s.selectedFilePOC=e.target.files[0],s.resultUpload=null,s.resultIngest=null,s.msg_process=null,s.msg_save=null,s})},this.setLoading=e=>{this.setState(t=>{let s={...t};return s.loading=e,s})},this.handleBack=e=>{window.location.href="/excelpro"},this.handleSavePOC=e=>{this.postRequest("/api/excelpro/save",this.startLoading,this.stopLoading,this.sucessCallBackSave,this.state.main_data)},this.handleViewInScreen=()=>{let e={template_columns:this.state.resultUpload.template_columns,uploadedFile:this.state.resultUpload.uploadedFile,main_data:this.state.main_data};this.postRequest("/api/excelpro/viewInScreen",this.startLoading,this.stopLoading,this.sucessCallBackViewInScreen,e)},this.handleIngestToEnvizi=()=>{let e={template_columns:this.state.resultUpload.template_columns,uploadedFile:this.state.resultUpload.uploadedFile,main_data:this.state.main_data};this.postRequest("/api/excelpro/ingestToEnvizi",this.startLoading,this.stopLoading,this.sucessCallBackIngestToEnvizi,e)},this.handleUploadData=async()=>{this.startLoading();try{var e=this.envUtility.getAPIUrl()+"/api/excelpro/uploadData";let t=new FormData;t.append("file",this.state.selectedFilePOC),t.append("envizi_template",this.state.main_data.envizi_template);let s=await l.Z.post(e,t,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"multipart/form-data"}});this.sucessCallBackUpload(s)}catch(e){console.error("Error uploading file",e),this.stopLoading()}},this.sucessCallBackUpload=async e=>{this.setState(t=>{let s={...t};return s.resultUpload=e.data,s.uploaded_columns=e.data.uploaded_columns,s.msg_process=e.data.msg,s.loading=!1,s})},this.sucessCallBackIngestToEnvizi=e=>{this.setState(t=>{let s={...t};return s.resultIngest=e,s.msg_process=e.msg,s.loading=!1,s})},this.sucessCallBackViewInScreen=e=>{this.setState(t=>{let s={...t};return s.resultIngest=e,s.msg_process=e.msg,s.loading=!1,s})},this.sucessCallBackLoadNew=e=>{this.setState(t=>{let s={...t};return s.main_data=e.data,s.loading=!1,s})},this.sucessCallBackLoad=e=>{this.setState(t=>{let s={...t};return s.main_data=e.data,s.loading=!1,s})},this.sucessCallBackClone=e=>{this.setState(t=>{let s={...t};return s.main_data=e.data,s.main_data.id="",s.loading=!1,s})},this.sucessCallBackTemplateChange=e=>{this.setState(t=>{let s={...t};return s.main_data=e.data,s.loading=!1,s})},this.sucessCallBackSave=e=>{this.setState(t=>{let s={...t};return s.main_data=e.data,s.msg_save=e.msg,s.loading=!1,s})},this.startLoading=()=>{this.setState(e=>{let t={...e};return t.msg=null,t.msg_process=null,t.msg_save=null,t.loading=!0,t})},this.stopLoading=e=>{console.log(e),this.setState(e=>{let t={...e};return t.loading=!1,t})},this.postRequest=(e,t,s,a,i)=>{this.apiUtility.postRequest(e,t,s,a,i)},this.getJsonDataType4=()=>({id:1,text_value:"",uploaded_column:"",operation_value:"",operation_elements:["Append","+","-","*","/"]}),this.addItemAfterIndex=(e,t)=>{setItems(s=>[...s.slice(0,t+1),e,...s.slice(t+1)])},this.addNewElementAfterId=(e,t)=>{let s=items.findIndex(t=>t.id===e);-1!==s&&addItemAfterIndex(t,s)},this.findItemIndexByName=e=>{let t=this.state.main_data.fields;for(let s=0;s<t.length;s++){let a=t[s];if(a.name===e)return s}return -1},this.addField=(e,t)=>{let s=this.findItemIndexByName(e);if(-1!==s){let e=this.getJsonDataType4(),a=this.state.main_data.fields[s];a.list.splice(t,0,e),this.setState(e=>{let t={...e};return t.main_data.fields[s].list=a.list,t})}},this.removeField=(e,t)=>{let s=this.findItemIndexByName(e);if(-1!==s){let e=this.state.main_data.fields[s];e.list.splice(t,1),this.setState(t=>{let a={...t};return a.main_data.fields[s].list=e.list,a})}},this.handleTextValueChange=(e,t)=>{let s=this.findItemIndexByName(t);-1!==s&&this.setState(t=>{let{value:a}=e.target,i={...t};return i.main_data.fields[s].text_value=a,i})},this.handleListValueChange=(e,t)=>{let s=this.findItemIndexByName(t);-1!==s&&this.setState(t=>{let a=e.selectedItem,i={...t};return i.main_data.fields[s].list_value=a,i})},this.handleUploadedColumnValueChange=(e,t)=>{let s=this.findItemIndexByName(t);-1!==s&&this.setState(t=>{let a=e.selectedItem,i={...t};return i.main_data.fields[s].uploaded_column=a,i})},this.handleSubTextValueChange=(e,t,s)=>{let a=this.findItemIndexByName(t);-1!==a&&this.setState(t=>{let{value:i}=e.target,n={...t};return n.main_data.fields[a].list[s].text_value=i,n})},this.handleSubListValueChange=(e,t,s)=>{let a=this.findItemIndexByName(t);-1!==a&&this.setState(t=>{let i=e.selectedItem,n={...t};return n.main_data.fields[a].list[s].uploaded_column=i,n})},this.handleOperationListValueChange=(e,t,s)=>{let a=this.findItemIndexByName(t);-1!==a&&this.setState(t=>{let i=e.selectedItem,n={...t};return n.main_data.fields[a].list[s].operation_value=i,n})},this.apiUtility=new r.Z,this.state={loading:!0,main_data:null,uploaded_columns:[""],selectedFilePOC:null,resultUpload:null,resultIngest:null,msg_process:null,msg_save:null},this.envUtility=new o.Z}};var m=ExcelDetailPage},4941:function(e,t,s){"use strict";s(2265);var a=s(4829),i=s(3354);t.Z=class{constructor(){this.postRequest=(e,t,s,n,l)=>{let d=new i.Z;var c=d.getAPIUrl()+e;t&&t(),a.Z.post(c,l,{headers:{"Access-Control-Allow-Origin":"*"}}).then(e=>{n(e.data)}).catch(e=>{s&&s(e)})}}}},1516:function(e,t,s){"use strict";var a=s(7437);s(2265),s(3473);var i=s(4659);t.Z=e=>{let{columns:t,jsonData:s,headingText1:n,headingText2:l}=e;return s&&0!==s.length?(0,a.jsxs)("div",{className:"my-component",children:[(0,a.jsxs)("div",{className:"fin-header-section",children:[(0,a.jsx)("div",{className:"fin-text-heading",children:n}),(0,a.jsx)("div",{className:"fin-text-heading-label",children:l})]}),(0,a.jsx)("div",{className:"fin-container",children:(0,a.jsx)(i.xJi,{children:(0,a.jsxs)(i.iA_,{"aria-label":"sample table",useZebraStyles:!0,children:[(0,a.jsx)(i.ssF,{children:(0,a.jsxs)(i.SCH,{children:[(0,a.jsx)(i.xDH,{children:"S.No"}),t.map(e=>(0,a.jsx)(i.xDH,{children:e}))]})}),(0,a.jsx)(i.RMI,{children:s.map((e,s)=>(0,a.jsxs)(i.SCH,{children:[(0,a.jsx)(i.pj1,{children:s+1},s),t.map(t=>(0,a.jsx)(i.pj1,{children:e[t]}))]},s))})]})})})]}):(0,a.jsx)("p",{})}},3354:function(e,t,s){"use strict";s(2265),t.Z=class{constructor(){this.getAPIUrl=()=>"http://localhost:3000/api"}}},3473:function(){},69:function(){},5349:function(){}},function(e){e.O(0,[501,513,829,930,971,472,744],function(){return e(e.s=7649)}),_N_E=e.O()}]);