(()=>{var e={};e.id=76,e.ids=[76],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},28436:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var o=r(67096),i=r(16132),a=r(37284),s=r.n(a),n=r(32564),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c=["",{children:["webhookdetail",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,57518)),"/Users/siraj/development/integration_hub/web/src/app/webhookdetail/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,85941)),"/Users/siraj/development/integration_hub/web/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/siraj/development/integration_hub/web/src/app/webhookdetail/page.tsx"],u="/webhookdetail/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new o.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/webhookdetail/page",pathname:"/webhookdetail",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},63078:(e,t,r)=>{Promise.resolve().then(r.bind(r,41355))},41355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>WebhookDetail});var o=r(30784),i=r(9885),a=r(21145);let WebhookService=class WebhookService{constructor(e){this.baseUrl=e,this.enviziApiUrl="https://usapi.envizi.com/api",this.enviziApiKey="eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYzMjM5MDYyLWM1NWUtNDdlNC1hYWFjLWQ0YTFhYWRhZDFiNSIsIm5hbWUiOiJqcDAwNzgwOTk4QHRlY2htYWhpbmRyYS5jb20iLCJzdWIiOiIxNzAwNzIzOSIsImVtYWlsIjoianAwMDc4MDk5OEB0ZWNobWFoaW5kcmEuY29tIiwianRpIjoiZjg0Y2YzZTUtMDQxNS00N2NjLTllMzQtNjUyYThhMmQ4Nzc1Iiwic2NvcGUiOlsiYXBpOm1ldGE6cmVhZCIsImFwaTpyZXBvcnQ6cmVhZCJdLCJuYmYiOjE3Mzc5NjI3NjYsImV4cCI6MjE0NzQ3MjAwMCwiaWF0IjoxNzM3OTM2MDAwLCJpc3MiOiJlbnZpemkuY29tIiwiYXVkIjoiYXBpLmVudml6aS5jb20ifQ.L_LGtBbJrsSnqWUEOUY4CJHZwpqaVEb6b5V4W6R0gUBZwK-rhkUa9DibncdoTSfm4q7XhpOK7ap9M96HPdCuyw",this.enviziOrgId="17000181"}async executeWebhook(e){try{console.log("Executing webhook with config:",e);let t=await (0,a.Z)({method:e.method,url:e.endpoint,headers:e.headers||{}});console.log("External API response:",t.data);let r=this.transformData(t.data,e.mapping);return console.log("Transformed data:",r),e.isTestMode||await this.sendToEnvizi(r,e.envizi),{success:!0,data:r,testMode:e.isTestMode,originalData:t.data}}catch(e){throw console.error("Webhook execution failed:",e),e}}transformData(e,t){let r={};for(let o of t){let t=this.getNestedValue(e,o.sourceField);o.transformation&&(t=this.applyTransformation(t,o.transformation)),this.setNestedValue(r,o.targetField,t)}return r}async sendToEnvizi(e,t){let r={Authorization:`Bearer ${t.apiKey}`,"Content-Type":"application/json"};await a.Z.post(`${t.endpoint}/organizations/${t.organizationId}/data`,e,{headers:r})}getNestedValue(e,t){return t.split(".").reduce((e,t)=>e?.[t],e)}setNestedValue(e,t,r){let o=t.split("."),i=o.pop(),a=o.reduce((e,t)=>(e[t]=e[t]||{},e[t]),e);a[i]=r}applyTransformation(e,t){switch(t){case"toUpperCase":return String(e).toUpperCase();case"toLowerCase":return String(e).toLowerCase();case"toNumber":return Number(e);default:return e}}};var s=r(11070);function WebhookDetail(){let[e,t]=(0,i.useState)(null),[r,a]=(0,i.useState)(!1),[n,l]=(0,i.useState)(null),c=new WebhookService("http://localhost:3000/api");(0,i.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("id");t&&loadConfig(t)},[]);let loadConfig=async e=>{a(!0);try{let r=await fetch(`/api/webhooks/${e}`),o=await r.json();t(o)}catch(e){console.error("Failed to load webhook config:",e)}finally{a(!1)}},handleSave=async()=>{if(e){a(!0);try{await fetch("/api/webhooks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.error("Failed to save webhook config:",e)}finally{a(!1)}}},handleTest=async()=>{if(e){a(!0);try{let t={...e,isTestMode:!0},r=await c.executeWebhook(t);l(r),console.log("Webhook test result:",r)}catch(e){console.error("Webhook test failed:",e),l({error:e?.message||"Unknown error occurred"})}finally{a(!1)}}},handleExecute=async()=>{if(e){a(!0);try{let t={...e,isTestMode:!1},r=await c.executeWebhook(t);l(r),console.log("Webhook execution result:",r)}catch(e){console.error("Webhook execution failed:",e),l({error:e?.message||"Unknown error occurred"})}finally{a(!1)}}};return r?o.jsx(s.Loading,{}):o.jsx(s.Grid,{children:(0,o.jsxs)(s.Column,{lg:16,md:8,sm:4,children:[o.jsx("h1",{children:"Webhook Configuration"}),o.jsx(s.TextInput,{id:"webhook-name",labelText:"Name",value:e?.name||"",onChange:e=>t(t=>({...t,name:e.target.value}))}),o.jsx(s.TextInput,{id:"webhook-name",labelText:"Endpoint",value:e?.endpoint||"",onChange:e=>t(t=>({...t,endpoint:e.target.value}))}),o.jsx(s.TextInput,{id:"webhook-name",labelText:"Envizi API Key",type:"password",value:e?.envizi.apiKey||"",onChange:e=>t(t=>({...t,envizi:{...t.envizi,apiKey:e.target.value}}))}),(0,o.jsxs)("div",{style:{marginTop:"1rem"},children:[o.jsx(s.Button,{onClick:handleSave,children:"Save"}),o.jsx(s.Button,{onClick:handleTest,children:"Test Webhook"}),o.jsx(s.Button,{onClick:handleExecute,disabled:!e?.envizi.apiKey,style:{marginLeft:"1rem"},children:"Execute Webhook"})]})]})})}},57518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>a,default:()=>l});var o=r(95153);let i=(0,o.createProxy)(String.raw`/Users/siraj/development/integration_hub/web/src/app/webhookdetail/page.tsx`),{__esModule:a,$$typeof:s}=i,n=i.default,l=n},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var o=r(31323);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,o.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[126,277,323,145,237],()=>__webpack_exec__(28436));module.exports=r})();